---
hide:
  - footer
---

# Amazon Route 53이 리소스의 상태를 확인하는 방법

---

Amazon Route 53 상태 확인은 웹 서버 및 이메일 서버 같은 리소스의 상태를 모니터링한다. 필요할 경우, 상태 확인이 가능하도록 Amazon CloudWatch 경보를 구성하여 리소스를 사용할 수 없게 될 때 알림을 수신할 수 있다.

다음은 리소스를 사용할 수 없게 될 때 알림을 수신하고자 하는 경우, 상태 확인이 작동하는 방식의 개요이다.

<figure markdown>
  ![001](https://docs.aws.amazon.com/ko_kr/Route53/latest/DeveloperGuide/images/how-health-checks-work.png){ load=lazy }
</figure>

1. 상태 확인을 생성하고 원하는 상태 확인 작동 방식을 정의하는 값을 지정하는 방법은 다음과 같다.

    - Route 53으로 모니터링하려는 웹 서버 등 엔드포인트의 IP 주소나 도메인 이름(다른 상태 확인의 상태 또는 CloudWatch 경보의 상태도 모니터링할 수 있다.)

    - Amazon Route 53이 상태 확인에 사용할 프로토콜: HTTP, HTTPS 또는 TCP.

    - Route 53이 엔드포인트에 요청을 전송하는 주기. 이것을 요청 간격이라고 한다.

    - Route 53이 비정상으로 판단하기 전에 엔드포인트가 요청에 대한 응답을 연속해 실패하는 횟수. 이것을 장애 임계치라고 한다.

    - 필요할 경우, 엔드포인트가 비정상임을 Route 53이 탐지할 때 원하는 알림 방식. 알림을 구성하면 Route 53에서 자동으로 CloudWatch 경보를 설정한다. CloudWatch는 Amazon SNS 사용하여 엔드포인트가 비정상임을 사용자에게 알린다.

2. Route 53은 사용자가 상태 확인에서 지정한 시간 간격으로 엔드포인트에 요청을 전송하기 시작한다.

    엔드포인트가 요청에 응답하면 Route 53은 엔드포인트가 정상이라고 판단하고 아무런 조치도 취하지 않는다.

3. 엔드포인트가 요청에 응답하지 않으면 Route 53은 엔드포인트가 응답하지 않는 연속적 요청 횟수를 세기 시작한다.

    - 횟수가 장애 임계치로 지정된 값에 도달하면 Route 53은 엔드포인트가 비정상이라고 판단한다.

    - 횟수가 장애 임계치에 도달하기 전에 엔드포인트가 다시 응답하기 시작하면 Route 53은 횟수를 0으로 리셋하고, CloudWatch는 사용자에게 연락하지 않는다.

4. Route 53이 엔드포인트가 비정상이라고 판단하고 사용자가 상태 확인 알림을 구성한 경우, Route 53은 CloudWatch에 알린다.

    알림을 구성하지 않은 경우에도 Route 53 콘솔에서 Route 53 상태 확인의 상태를 확인할 수 있다.

5. 상태 확인 알림을 구성한 경우, CloudWatch는 경보를 트리거하고 Amazon SNS를 사용하여 지정된 수신자에게 알림을 전송한다.

지정된 엔드포인트의 상태 확인 외에도 하나 이상의 다른 상태 확인을 검사하도록 상태 확인을 구성하면 지정된 수의 리소스(예컨대 5대의 웹 서버 중 2대)를 사용할 수 없을 때 알림을 수신할 수 있다. 또 CloudWatch 경보의 상태를 확인하도록 상태 확인을 구성하면 리소스가 요청에 응답하는 경우뿐 아니라 다양한 기준에 따라 알림을 수신할 수 있다.

웹 서버 또는 데이터베이스 서버와 같이 동일한 기능을 수행하는 다수의 리소스를 보유한 상황에서 Route 53이 트래픽을 정상적인 리소스에만 라우팅하도록 만들고 싶다면 상태 확인을 해당 리소스의 각 레코드에 연결하여 DNS 장애 조치를 구성할 수 있다. 상태 확인이 기본 리소스가 비정상이라고 판정하면, Route 53은 연결된 레코드에서 벗어나도록 트래픽을 라우팅한다.

---

## References

- <https://docs.aws.amazon.com/ko_kr/Route53/latest/DeveloperGuide/welcome-health-checks.html>
