# 2. awk 프로그래밍

---

## 이전 페이지

[1. awk 사용법 알아보기](1%20awk%20%E1%84%89%E1%85%A1%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%87%E1%85%A5%E1%86%B8%20%E1%84%8B%E1%85%A1%E1%86%AF%E1%84%8B%E1%85%A1%E1%84%87%E1%85%A9%E1%84%80%E1%85%B5%20dcd825e00cbd476c892edbe634e218ed.md)

## 다음 페이지

[3. awk 옵션](3%20awk%20%E1%84%8B%E1%85%A9%E1%86%B8%E1%84%89%E1%85%A7%E1%86%AB%201180d54712ac45b0931fcdc821a83f87.md)

---

`awk` 프로그래밍은 어떤 인덱스의 값을 추출할 것인지를 명시하는 일을 한다. 그래서, `awk` 프로그램을 작성할 때는 기본적으로 어떤 값을 추출할 것인지를 명시하는 패턴$^{Patterns}$과 추출된 레코드를 전부 출력할 것인지, 특정 필드의 값만 출력할 것인지를 명시하는 액션으로 이루어진다. 그리고, `awk`는 패턴이 명시되지 않으면 액션$^{Actions}$에 명시된 해당 필드 값을 모두 출력한다. 따라서 패턴을 생략할 수도 있고, 액션을 생성할 수도 있다. 또한 `awk` 프로그래밍을 이용하여 다양한 프로그램을 만들 수 있다. 아마도 그런 설명을 전부 나열한다면 책을 한 권 쓸 정도의 분량이 나올 것이다. 여기서는 셸 스크립트에서 가장 많이 사용하고, 실무에서 유용하게 사용하는 기능들만 정리하여 설명한다. 지금부터 `awk` 명령어의 핵심인 액션과 패턴을 알아보자.

- 액션
- 패턴

## 1. 액션

`awk`의 액션은 `{}`(중괄호) 사이에 기술된다. 액션은 제어문(조건문, 반복문 등)과 입/출력문(`print`, `printf`)으로 구성된다. `awk`에서 사용할 수 있는 모든 액션의 종류를 살펴보면 좋겠지만, 여기서는 주로 사용되는 입/출력문과 관련된 액션을 살펴보도록 한다. 다음 표는 입/출력문에 대한 액션들을 정리한 것이다.

| 액션 | 설명 |
| --- | --- |
| print | 대상 파일 내용을 그대로 출력함 |
| print 필드리스트 | 대상 파일의 필드 인덱스($0 ~ $n), 자체 변수(NF, FNR 등), 문자열 등을 조합하여 명시한 대로 출력함 |
| print 필드리스트 > 파일 | 대상 파일의 필드 인덱스($0 ~ $n), 자체 변수(NF, FNR 등), 문자열 등을 조합하여 명시한 대로 파일에 출력함 |
| printf 포맷, 필드리스트 | 명시한 대상 파일의 필드 인덱스를 명시한 포맷에 맞추어 출력함 |
| printf 포맷, 필드리스트 > 파일 | 명시한 대상 파일의 필드 인덱스를 명시한 포맷에 맞추어 파일에 출력함 |
| getline | 대상 파일의 짝수 라인과 마지막 라인을 읽어들임
단독으로 사용할 수 없으며, print 등과 함께 사용해야 함 |
| getline var | 대상 파일의 홀수 라인을 읽어들여 단독으로 사용할 수 없으며, print 등과 함께 사용해야 함 |
| getline < 파일 | 명시한 파일의 값을 읽어들임
단독으로 사용할 수 없으며, print 등과 함께 사용해야 함 |
| getline var < 파일 | 명한 파일의 값을 읽어 var에 저장함
print 등과 함께 사용해야 하며 파일에 명시된 숫자에 해당하는 필드를 출력함 |

## 2. 패턴

패턴$^{Patterns}$은 `awk`를 이용해 대상 파일에서 어떤 레코드를 출력할 것인지에 대해 명시하는 것이다. 예를 들어, 파일 내용에 정규 표현식으로 표현한 값이 있는지, 숫자와 숫자 또는 문자와 문자를 비교할 수도 있다. 이런 관계식을 나열하여 논리 연산을 할 수도 있다. 다음은 이런 패턴의 유형을 정리하고, 그에 대한 간략한 설명을 곁들인 것이다.

| 패턴 | 설명 |
| --- | --- |
| BEGIN { 액션 }
END { 액션 } | 입력된 데이터의 첫 번째 레코드를 읽기 전에 BEGIN에 의해 선언된 액션을 먼저 처리하며, END는 모든 작업 완료 후 마지막에 END 액션을 처리함 |
| BEGINFILE { 액션 }
ENDFILE { 액션 } | BEGIN { 액션 }, END { 액션 }과 동일하며, FILENAME이라는 awk 자체 변수를 사용할 경우에만 BEGINFILE과 ENDFILE을 사용함 |
| /정규 표현식/ | 패턴을 정규 표현식 형태로 작성할 경우 //(슬래시) 사이에 표현함 |
| 관계식 | 관계식은 말 그대로 필드와 패턴 값을 비교할 경우 산술 연산자를 사용하여 비교할 수 있음 |
| 패턴1 && 패턴2 | 패턴이나 관계식을 AND 연산함 |
| 패턴1 || 패턴2 | 패턴이나 관계식을 OR 연산함 |
| 패턴1 ? 패턴2 : 패턴3 | C의 연산자와 같은 의미로 패턴1(또는 관계식)이 true이면 패턴2가 리턴되며, false이면 패턴3이 리턴됨 |
| ( 패턴 ) | 패턴이나 관계식을 그룹핑하거나 우선순위를 높임 |
| !패턴 | 패턴이나 관계식을 NOT 연산함 |
| 패턴1, 패턴2 | 패턴1, 패턴2 형식을 범위 패턴이라고 하며, 패턴1부터 패턴2 사이에 해당하는 레코드를 출력함 |

---

## 이전 페이지

## 다음 페이지